{% extends 'courses/base.html' %}

{% block title %}ä¿®èª²å­¸ç”Ÿ - {{ course.course_name }}{% endblock %}

{% block content %}
<div class="mb-3">
    <a href="{% url 'courses:teacher_dashboard' %}" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> è¿”å›
    </a>
</div>

<h1>ğŸ‘¥ {{ course.course_name }} - ä¿®èª²å­¸ç”Ÿ</h1>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <p><strong>èª²è™Ÿï¼š</strong> {{ course.course_code }}</p>
                <p><strong>å­¸åˆ†ï¼š</strong> {{ course.credits }}</p>
                <p><strong>é¸ä¿®äººæ•¸ï¼š</strong> <span class="badge bg-primary">{{ enrollments.count }}/{{ course.max_students }}</span></p>
            </div>
        </div>
    </div>
</div>

{% if enrollments %}
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>å­¸ç”Ÿåç¨±</th>
                    <th>æœŸä¸­åˆ†æ•¸</th>
                    <th>æœŸæœ«åˆ†æ•¸</th>
                    <th>ç§‘ç›®åˆ†æ•¸</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for enrollment in enrollments %}
                    <tr>
                        <td>
                            <strong>{{ enrollment.user.get_full_name }}</strong><br>
                            <small class="text-muted">{{ enrollment.user.username }}</small>
                        </td>
                        <td>
                            <form method="POST" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="enrollment_id" value="{{ enrollment.id }}">
                                <input type="number" step="0.01" min="0" max="100" name="midterm_score" 
                                       value="{{ enrollment.midterm_score|default:'' }}" class="form-control form-control-sm" 
                                       style="max-width: 100px;">
                        </td>
                        <td>
                                <input type="number" step="0.01" min="0" max="100" name="final_score" 
                                       value="{{ enrollment.final_score|default:'' }}" class="form-control form-control-sm" 
                                       style="max-width: 100px;">
                                <button type="submit" class="btn btn-sm btn-primary mt-1">ä¿å­˜</button>
                                </form>
                        </td>
                        <td>
                            {% if enrollment.get_total_score %}
                                <strong class="text-success">{{ enrollment.get_total_score }}</strong>
                            {% else %}
                                <span class="badge bg-warning">å¾…ç™»éŒ„</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'courses:course_detail' course.id %}" class="btn btn-sm btn-info">
                                <i class="fas fa-comment"></i>
                            </a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <div class="alert alert-info">
        <i class="fas fa-info-circle"></i> ç›®å‰æ²’æœ‰å­¸ç”Ÿé¸ä¿®æ­¤èª²ç¨‹ã€‚
    </div>
{% endif %}
{% endblock %}
